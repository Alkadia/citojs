var cito=window.cito||{};!function(e,t,n){"use strict";function r(e){return"string"==typeof e}function i(e){return e instanceof Array}function o(e){return"function"==typeof e}function a(e){return e.then!==n}function f(e,t){var n=typeof e;return"string"===n?{tag:"#",children:e}:"function"===n?f(e(t),t):e}function l(e,t,n,r){var i,o=t[n];if(o&&a(o)){e.dom.virtualNode=e,i={};var l=!0;o.then(function(e){l?i=f(e):t[n]===i&&U.update(i,e)}),l=!1}else i=f(o,r);return o!==i&&(t[n]=i),i}function d(e,t,n){var r,f=t;if(t)if(a(t)){e.dom.virtualNode=e,t=[];var l=!0;f.then(function(r){l?t=d(e,r,n):e.children===t&&U.updateChildren(e,r)}),l=!1}else o(t)&&(t=t(n));return i(t)||(t=t&&(t.children||"#"!==(r=t.tag)&&"<"!==r)?[t]:[]),f!==t&&(e.children=t),t}function c(e,t,n){var r,i=t.dom,o=t.domLength||1,a=n&&n.dom;if(i!==a)for(;o--;)r=o>0?i.nextSibling:null,a?e.insertBefore(i,a):e.appendChild(i),i=r}function u(e,t,n){if(1===n.nodeType)n.insertAdjacentHTML("beforebegin",t);else{z.innerHTML=t;for(var r;r=z.firstChild;)e.insertBefore(r,n)}}function s(e,t,n,r){if(n){var i=n.dom;if(r){var o=n.domLength||1;1===o?(O(n),e.replaceChild(t,i)):(e.insertBefore(t,i),L(e,n))}else e.insertBefore(t,i)}else e.appendChild(t)}function v(e,t,n,r,i,o){var a,f=e.tag,l=e.children;if(f){switch(f){case"#":a=I.createTextNode(l);break;case"!":a=I.createComment(l);break;case"<":if(l){var c=t.childNodes,v=c.length;if(i){var g=i.dom,p=g.previousSibling;u(t,l,g),a=p?p.nextSibling:t.firstChild}else t.insertAdjacentHTML("beforeend",l),a=c[v];return e.dom=a,e.domLength=c.length-v,void(o&&i&&L(t,i))}a=I.createTextNode("");break;default:var y;switch(f){case"svg":y="http://www.w3.org/2000/svg";break;case"math":y="http://www.w3.org/1998/Math/MathML";break;default:y=n}return y?(e.ns=y,a=I.createElementNS(y,f)):a=I.createElement(f),e.dom=a,m(a,null,null,e,f,e.attrs,e.events),l=d(e,l),w(a,e,y,l,0,l.length,l.length>1),void(t&&s(t,a,i,o))}e.dom=a,t&&s(t,a,i,o)}else h(e,l,t,n,r,i,o)}function h(e,t,n,r,i,o,a){t=d(e,t);var f,c,u=t.length;if(r&&(e.ns=r),0===u)f=I.createTextNode(""),s(n,f,o,a);else{i=i||u>1,c=0;for(var h=0;u>h;h++){var m=l(e,t,h);v(m,n,r,i,o,!1),c+=m.domLength||1}f=t[0].dom,a&&L(n,o)}e.dom=f,e.domLength=c}function m(e,t,r,i,o,a,f){var l;if(a)for(l in a){var d=a[l];if("style"===l){var c=t&&t[l];c!==d&&g(e,c,a,d)}else if(p(o,l))e[l]!==d&&(e[l]=d);else if(!t||t[l]!==d)if(d===!1)e.removeAttribute(l);else{d===!0&&(d="");var u,s=l.indexOf(":");if(-1!==s){var v=l.substr(0,s);switch(v){case"xlink":u="http://www.w3.org/1999/xlink"}}u?e.setAttributeNS(u,l,d):e.setAttribute(l,d)}}if(t)for(l in t)a&&a[l]!==n||(p(o,l)?e[l]="":e.removeAttribute(l));var h;if(f){e.virtualNode=i;for(h in f)r&&r[h]||y(e,h)}if(r)for(h in r)f&&f[h]||k(e,h)}function g(e,t,i,o){var a;if(!(r(o)||K&&t&&!r(t))){var f="";if(o)for(a in o)f+=a+": "+o[a]+"; ";o=f,K||(i.style=o)}var l=e.style;if(r(o))l.cssText=o;else{if(o)for(a in o){var d=o[a];if(!t||t[a]!==d){var c=d.indexOf("!important");if(-1!==c)l.setProperty(a,d.substr(0,c),"important");else{if(t){var u=t[a];u&&-1!==u.indexOf("!important")&&l.removeProperty(a)}l.setProperty(a,d,"")}}}if(t)for(a in t)o&&o[a]!==n||l.removeProperty(a)}}function p(e,t){switch(e){case"input":return"value"===t||"checked"===t;case"textarea":return"value"===t;case"select":return"selectedIndex"===t;case"option":return"selected"===t}}function y(e,t){if(G)e.addEventListener(t,P,!1);else{var n="on"+t;n in e?e[n]=P:e.attachEvent(n,P)}}function k(e,t){if(G)e.removeEventListener(t,P,!1);else{var n="on"+t;n in e?e[n]=null:e.detachEvent(n,P)}}function b(e){return r(e)?e:"#"===e.tag?e.children:null}function w(e,t,n,r,i,o,a,f){if(0===i&&1===o&&!a){var d=r[0],c=b(d);if(null!==c)return void C(e,c);if("<"===d.tag)return void(e.innerHTML=d.children)}for(;o>i;i++)v(l(t,r,i),e,n,a,f)}function x(e,t,n,r){if(0===n&&1===r&&1===t.length){var i=t[0];if(!i.dom){for(var o;o=e.firstChild;)e.removeChild(o);return}}for(;r>n;n++)L(e,t[n])}function L(e,t){O(t);for(var n,r=t.dom,i=t.domLength||1;i--;)n=i>0?r.nextSibling:null,e.removeChild(r),r=n}function C(e,t){F?e.textContent=t:e.innerText=t}function N(e,t,n,r){var i=r[0],o=t[0],a=b(i),f=0!==n,l=!1;if(null!==a){if(!f){var d=b(o);l=null!==d,f=a!==d}f&&(l||V(t),C(e,a))}else"<"===i.tag?(f||(l="<"===o.tag,f=!l||i.children!==o.children),f&&(l||V(t),e.innerHTML=i.children)):f=!1;return f||l}function T(e,t,n,r,i,o,a){i=d(t,i,r);var f=r.length-1,u=i.length-1;if(o=o||u>0,0!==u||o||!N(e,r,f,i)){if(0===f){var s=l(t,r,0);s.dom||(s.dom=e.firstChild,"<"===s.tag&&(s.domLength=e.childNodes.length))}var h,m=0,g=0,p=!0;e:for(;p&&f>=m&&u>=g;){p=!1;var y,k,b,C;for(y=r[m],b=l(t,i,g,y);y.key===b.key;){if(h=r[m+1]||a,H(y,b,e,n,o,h),m++,g++,m>f||g>u)break e;y=r[m],b=l(t,i,g,y),p=!0}for(k=r[f],C=l(t,i,u,k);k.key===C.key;){if(h=i[u+1]||a,H(k,C,e,n,o,h),f--,u--,m>f||g>u)break e;k=r[f],C=l(t,i,u),p=!0}for(;y.key===C.key;){if(h=i[u+1]||a,H(y,C,e,n,o,h),c(e,C,h),m++,u--,m>f||g>u)break e;y=r[m],C=l(t,i,u),p=!0}for(;k.key===b.key;){if(h=r[m]||a,H(k,b,e,n,h),c(e,b,h),f--,g++,m>f||g>u)break e;k=r[f],b=l(t,i,g),p=!0}}if(m>f)h=l(t,i,u+1)||a,w(e,t,n,i,g,u+1,o,h);else if(g>u)x(e,r,m,f+1);else{var T,P,E=r[f+1],M={};for(T=f;T>=m;T--)P=r[T],P.next=E,M[P.key]=P,E=P;for(h=l(t,i,u+1)||a,T=u;T>=g;T--){var A=i[T],S=A.key;P=M[S],P?(M[S]=null,E=P.next,H(P,A,e,n,o,h),(E&&E.key)!==(h&&h.key)&&c(e,A,h)):v(A,e,n,o,h),h=A}for(T=m;f>=T;T++)P=r[T],null!==M[P.key]&&L(e,P)}}}function P(e){e=S(e,this);var t=e.currentTarget,n=t.virtualNode.events[e.type];if(i(n)){for(var r=0,o=n.length;o>r;r++)if(B(n[r],t,e),Q){Q=!1;break}}else B(n,t,e)}function E(){this.defaultPrevented=!0,this.returnValue=!1}function M(){this.cancelBubble=!0}function A(){Q=!0,this.stopPropagation()}function S(e,n){return e||(e=t.event,e.preventDefault||(e.preventDefault=E,e.stopPropagation=M,e.defaultPrevented=e.returnValue===!1,e.target=e.srcElement),e.currentTarget=n.nodeType?n:e.target),e.stopImmediatePropagation=A,e}function B(e,t,n){try{e.call(t,n)===!1&&n.preventDefault()}catch(r){q.error(r.stack||r)}}function H(e,t,n,r,i,o){var a,f=t.tag,l=e.children,d=t.children;if(e.tag!==f)v(t,n,r,i,e,!0);else if(f)switch(a=e.dom,f){case"#":case"!":l!==d&&(a.nodeValue=d),t.dom=a;break;case"<":l!==d?v(t,n,c,i,e,!0):(t.dom=e.dom,t.domLength=e.domLength);break;default:var c=e.ns;c&&(t.ns=c),t.dom=a,m(a,e.attrs,e.events,t,f,t.attrs,t.events),T(a,t,c,l,d,!1)}else D(e,l,t,d,n,r,i,o)}function D(e,t,n,r,i,o,a,f){r=d(n,r,t);var l,c,u=t.length,v=r.length;if(o&&(n.ns=o),a=a||v>1,0===v)0===u?l=e.dom:(x(i,t,0,t.length),l=I.createTextNode(""),s(i,l,f));else if(0===u)i.removeChild(e.dom),h(n,r,i,o,a,f);else if(T(i,n,o,t,r,a,f),v>0){l=r[0].dom,c=0;for(var m=0;v>m;m++)c+=r[m].domLength||1}n.dom=l,n.domLength=c}function O(e){if(!r(e)){var t=e.dom;if(t){var i=e.events;if(i)for(var o in i)k(t,o);t.virtualNode&&(t.virtualNode=n)}var a=e.children;r(a)||V(a)}}function V(e){for(var t=0,n=e.length;n>t;t++)O(e[t])}function j(e,t){var r;for(r in e)t[r]=e[r];for(r in t)e[r]===n&&(t[r]=n)}var I=t.document,R=function(){},q=t.console||{warn:R,error:R},z=I.createElement("div"),F="textContent"in I,G="addEventListener"in I,J="createRange"in I,K="setProperty"in z.style,Q=(J?I.createRange():null,!1),U=e.vdom={create:function(e){return e=f(e),v(e),e},append:function(e,t){return t=U.create(t),e.appendChild(t.dom),t},update:function(e,t){return t=f(t,e),H(e,t,e.dom.parentNode),j(t,e),e},updateChildren:function(e,t){var n=e.children;t=d(e,t,n),T(e.dom,e,e.ns,n,t),e.children=t},remove:function(e){var t=e.dom.parentNode;L(t,e)}}}(cito,window);